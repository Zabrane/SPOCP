#
# $Id: rules.txt,v 1.89 2005/11/28 09:56:09 kllin Exp $
#

#
# test
#
it-sysadm := "localgroup:{//uid[1]}:it-sysadm:${0}"
it-staff := "localgroup:{//uid[1]}:it-staff:${0}"
helpdesk := "localgroup:{//uid[1]}:helpdesk:${0}"
su-inst-staff-base := "ldapset:{//uid[1]}{//departmentNumber[1]}:ds-slave.su.se;dc=se;c=SE;{\\0$uid & ${0}}/eduPersonOrgUnitDN & {\\1$departmentNumber & ${1}}"
su-inst-staff-sub := "ldapset:{//uid[1]}{//departmentNumber[1]}:ds-slave.su.se;dc=se;c=SE;{{\\0$uid & ${0}}/eduPersonOrgUnitDN} & {{\\1$departmentNumber & ${1}}$objectClass & organizationalUnit}"
#
su-employee := "ldapset:{//uid[1]}:ds-slave.su.se;dc=se;{\\0$uid & ${0}}/eduPersonAffiliation & employee"
#su-student := "ldapset:{//uid[1]}:ds-slave.su.se;dc=se;{\\0$uid & ${0}}/eduPersonAffiliation & student"
#su-primary-student := "ldapset:{//uid[1]}:ds-slave.su.se;dc=se;{\\0$uid & ${0}}/eduPersonPrimaryAffiliation & student"

(test (host 
       (* suffix .it.su.se)) 
      (uid))

(test3	(host (* suffix .it.su.se))
	(uid))

(test2 (host (* suffix .it.su.se))
       (uid))

(isstudent (uid))

(nagiostest (uid su-nagiosd))

//hypatia/server/(server(ip)(host))
//hypatia/operation/(operation QUERY(server(ip)(host)))
//hypatia/operation/(operation SUMMARY(server(ip)(host)))
//hypatia/operation/(operation LOGOUT(server(ip)(host)))
